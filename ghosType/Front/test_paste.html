<!DOCTYPE html>
<html>
<head>
    <title>Paste Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-input { width: 300px; padding: 10px; margin: 10px 0; border: 1px solid #ccc; }
        .test-textarea { width: 300px; height: 100px; padding: 10px; margin: 10px 0; border: 1px solid #ccc; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Paste Functionality Test</h1>
    
    <h2>Test Input Field</h2>
    <input type="text" id="testInput" class="test-input" placeholder="Paste some text here..." />
    
    <h2>Test Textarea</h2>
    <textarea id="testTextarea" class="test-textarea" placeholder="Paste some text here..."></textarea>
    
    <div id="result" class="result">
        <strong>Last pasted content:</strong><br>
        <span id="pastedContent">No paste detected yet</span>
    </div>
    
    <script>
        // Clean function for pasted text
        function cleanPastedText(text) {
            return text.replace(/[^\x00-\x7F\uAC00-\uD7A3\u3130-\u318F]/g, '');
        }
        
        // Add paste handlers
        ['testInput', 'testTextarea'].forEach(id => {
            const element = document.getElementById(id);
            element.addEventListener('paste', function(event) {
                event.preventDefault();
                
                const clipboardData = event.clipboardData || window.clipboardData;
                let pastedText = clipboardData.getData('text');
                
                // Clean the pasted text
                const cleanedText = cleanPastedText(pastedText);
                
                // Insert the cleaned text at cursor position
                const startPos = element.selectionStart;
                const endPos = element.selectionEnd;
                const textBefore = element.value.substring(0, startPos);
                const textAfter = element.value.substring(endPos);
                
                element.value = textBefore + cleanedText + textAfter;
                
                // Set cursor position after pasted text
                const newCursorPos = startPos + cleanedText.length;
                element.setSelectionRange(newCursorPos, newCursorPos);
                
                // Update result display
                document.getElementById('pastedContent').innerHTML = 
                    `Original: "${pastedText}"<br>Cleaned: "${cleanedText}"<br>Length: ${cleanedText.length}`;
            });
        });
    </script>
</body>
</html>